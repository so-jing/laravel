define(function(require){require("common"),require("./common/common.js"),require("/static/component/base/placeholder/placeholder.js");var a=(require("/static/page/user/messagebox.js"),require("/static/page/user/common/settingUitl.js"),'<div class="edit-info">                    <form class="js-wapper-form" id="profile">'+$(".js-wapper-form").html()+'<div class="wlfg-wrap clearfix">                		<label class="moco-control-label" for=""></label>		                <div class="moco-control-input">		                    <a href="javascript:void(0);" id="profile-submit" class="moco-btn moco-btn-blue marR10">确定</a>		                    <a href="javascript:void(0);" class="moco-btn moco-btn-normal js-modal-close">取消</a>		                    <p class="js-gerror g_error"></p>		                </div>		            </div>');$(document).on("click",".js-edit-info",function(){$.dialog(a,{title:"编辑个人信息",modal:!0});var c=128-$("#profile .js-sign").val().length;c>=0?$("#profile .js-numCanInput").html("还可以输入"+c+"个字符"):(c=0-c,$("#profile .js-numCanInput").html('已超出<span class="color-red">'+c+"</span>个字符"))});$(document).delegate("#profile .js-sign","change",function(){var a=128-$("#profile .js-sign").val().length;a>=0?$("#profile .js-numCanInput").html("还可以输入"+a+"个字符"):(a=0-a,$("#profile .js-numCanInput").html('已超出<span class="color-red">'+a+"</span>个字符"))}),$(document).delegate("#profile .js-sign","keyup",function(){var a=128-$("#profile .js-sign").val().length;a>=0?$("#profile .js-numCanInput").html("还可以输入"+a+"个字符"):(a=0-a,$("#profile .js-numCanInput").html('已超出<span class="color-red">'+a+"</span>个字符"))}),$(document).delegate("#profile .js-sign","keydown",function(){var a=128-$("#profile .js-sign").val().length;a>=0?$("#profile .js-numCanInput").html("还可以输入"+a+"个字符"):(a=0-a,$("#profile .js-numCanInput").html('已超出<span class="color-red">'+a+"</span>个字符"))}),$(document).on("change","#profile #province-select",function(){$("#profile #city-select").text("").append("<option value='0'>选择城市 </option>"),$("#profile #area-select").text("").append("<option value='0'>选择区县 </option>"),$.get("/user/ajaxchangeprov","id="+$(this).val(),function(a){if(a&&1==a.result)for(var c=$("#profile #city-select"),d=a.data,v=d.length,i=0;v>i;i++)c.append("<option value="+d[i].id+" >"+d[i].name+" </option>")},"json")}),$(document).on("change","#profile #city-select",function(){$("#profile #area-select").text("").append("<option value='0'>选择区县 </option>"),$.get("/user/ajaxchangecity","id="+$(this).val(),function(a){if(a&&1==a.result)for(var c=$("#profile #area-select"),d=a.data,v=d.length,i=0;v>i;i++)c.append("<option value="+d[i].id+" >"+d[i].name+" </option>")},"json")}),$(document).on("click","#profile-submit",function(){var a=128-$("#profile .js-sign").val().length;if(a>=0){var c,v=$(this);if("正在保存..."!=v.text())if(v.text("正在保存..."),c=v.closest("form"),W.validate()){var j='<div class="suc-tip"><i class="icon-full"></i>保存成功</div>',g={type:1};g.job=$("#profile #job").val(),g.sex=$("#profile input[name='sex']:checked").val(),g.portrait=$("#profile #js-portrait").attr("data-portrait"),g.nickname=$("#profile #nick").val(),g.about=$("#profile #aboutme").val(),g.province=$("#profile #province-select").val(),g.city=$("#profile #city-select").val(),g.area=$("#profile #area-select").val(),$.ajax({url:"/user/ajaxsetinfo",data:g,method:"post",dataType:"json",success:function(a){1==a.result?($(".js-modal-close").click(),$("body").append(j),setTimeout(function(){window.location.reload()},1e3)):$.alert("error",{info:a.msg}),v.text("保存")},error:function(){$.alert("error",{info:"修改失败！"}),v.text("保存")}})}else v.text("保存")}})});
define(function(require){require("common"),require("/static/lib/layer/1.6.0/layer.min.js"),require("/static/lib/layer/1.6.0/skin/layer.css"),require("/static/page/wenda/wendalist.js"),require("/static/lib/ueditor/ueditor.parse.js");var a=require("store"),c=require("/static/component/base/util/wendaGuide");$("#js-newques").click(function(e){e.preventDefault();var a=document.cookie,c=a.match(/(?:;|^)\s*loginstate=([^;])/);c&&c[1]&&"0"!=c[1]?window.location.href="/wenda/save":seajs.use("login_sns",function(a){a.init()})}),uParse("body",{rootPath:"/static/component/base/ueditor/",chartContainerHeight:500});var g={keywordClick:function(){var a=$(this);a.hasClass("curr")?a.removeClass("curr"):a.addClass("curr"),0==$(".js-keyword.curr").length?$("a.js-all-keyword").addClass("curr"):$("a.js-all-keyword").removeClass("curr")},allKeywordClick:function(){$(this).addClass("curr"),$("a.js-keyword").removeClass("curr")},setCustom:function(){var a=[];$.each($(".js-keyword.curr"),function(c,g){a.push($(g).data("id"))});var g=a.length;$.ajax({url:"/wenda/customtag",type:"post",dataType:"json",data:{tagIds:a.join(",")},success:function(a){0==a.result&&($(".js-custom-layout").hide(),g>1?$(document).trigger(c.create(function(){window.location="/wenda"})):window.location="/wenda")}})},cancelCustom:function(){var a=[];""!==initHotLabel&&(a=initHotLabel.split(",")),$(".js-keyword.curr").removeClass("curr"),0!=a.length?$.each($(".js-keyword"),function(c,g){for(var i=0,h=a.length;h>i;i++)$(g).attr("data-id")==a[i]&&$(g).addClass("curr")}):$(".js-all-keyword").addClass("curr"),$(".js-custom-layout").hide()}},h=function(){$(".js-switch").on("click",function(){var a=$(this),c=a.hasClass("on")?"2":"1",g="1"==c?"20px":"0px",h="1"==c?"0px":"-20px";a.find(".outer").animate({marginLeft:h},"fast"),a.find(".inner").animate({left:g},"fast",function(){"1"==c?a.addClass("on"):a.removeClass("on"),$.ajax({url:"/wenda/ajaxsetfilter",type:"post",data:{"switch":c},dataType:"json"}).done(function(){location=location})})}),$(".js-keyword-list").on("click","a.js-keyword",g.keywordClick).on("click","a.js-all-keyword",g.allKeywordClick),$(".js-btn-custom-hide").click(function(){$(".js-custom-layout").hide()}),1==$(".js-custom-tag").data("hadtag")&&$(".js-custom-layout").show(),$(".js-custom-save").click(g.setCustom),$(".js-custom-cancel").click(g.cancelCustom)},w=function(){},j=function(){h(),w()};j();var v=function(){var a=$(document).scrollTop();return $(document).width()<980?void $(".wenda-sidebar").hide():($(".wenda-sidebar").show(),void(a>70?$(".wenda-sidebar").addClass("fixed"):$(".wenda-sidebar").removeClass("fixed")))};$(window).scroll(v),v();var y=0;$(".js-user-tc").on("click",function(){if(!y){y=1;var a=$(this),c=a.attr("data-id"),g="show";"数据删除"==a.html()&&(g="hide");var h="/wenda/audit";$.ajax({type:"get",url:h,dataType:"json",data:{quesId:c,act:g},success:function(c){y=0,0==c.result?a.html("show"==g?"数据删除":"恢复上架"):layer.msg("操作失败，请稍后再试",1,1)},error:function(){layer.msg("网络错误，请稍后再试",1,1),y=0}})}});var k=$("#has-label").attr("data-hadlabel");if("index"==OP_CONFIG.page&&OP_CONFIG.userInfo&&"1"==k){var C=a.get("isFirstCome")||"Yes";"Yes"===C&&c.create()}var b,I,T=500,_=$(".js-search-tag");$(".search-tags-ipt").on("keyup",function(){b&&clearTimeout(b),b=setTimeout(function(){I=$.trim($(".search-tags-ipt").val()),$.ajax({url:"/wenda/searchlabel",data:{label:I},type:"POST",dataType:"json",success:function(a){"1"==a.result?(_.empty(),$.each(a.data,function(i,a){1==a.is_regist?($('<li><a href="/wenda/tag/tagId/'+a.id+'" class="tag-img l" target="_blank">									<img src="//img.mukewang.com/'+a.pic+'.jpg" widt="32" height="32" title="000" />									</a><div class="tag-detail l"><a href="/wenda/tag/tagId/'+a.id+'" target="_blank">'+a.name+"</a><i>关注："+a.num+'人</i></div>									<a class="tag-followed at-tag" href="javascript:void(0)" data-tagIds="'+a.id+'">取消关注</a></li>').appendTo(_),_.show()):0==a.is_regist&&($('<li><a href="/wenda/tag/tagId/'+a.id+'" class="tag-img l" target="_blank">									<img src="//img.mukewang.com/'+a.pic+'.jpg" widt="32" height="32" title="000" />									</a><div class="tag-detail l"><a href="/wenda/tag/tagId/'+a.id+'" target="_blank">'+a.name+"</a><i>关注："+a.num+'人</i></div>									<a class="tag-will-fol at-tag" href="javascript:void(0)" data-tagIds="'+a.id+'">关注</a></li>').appendTo(_),_.show())})):"0"==a.result&&(_.empty(),$("<li><p>未找到你感兴趣的标签</p></li>").appendTo(_),_.show())},error:function(){}})},T)});var O=0,P=function(a){var c=a,g=c.attr("data-tagIds");"关注"==c.text()?$.ajax({url:"/wenda/followtag",data:{tagIds:g},type:"POST",dataType:"json",success:function(a){O=0,0==a.result&&c.removeClass("tag-will-fol").addClass("tag-followed").text("取消关注")}}):"取消关注"==c.text()&&$.ajax({url:"/wenda/canceltag",data:{tagIds:g},type:"POST",dataType:"json",success:function(a){O=0,0==a.result&&c.removeClass("tag-followed").addClass("tag-will-fol").text("关注")}})};_.delegate(".at-tag","click",function(){if(_.find(".at-tag").length){if(O)return;O=1,P($(this))}}),$(".panel,.js-qa-follows").delegate(".at-tag","click",function(){return OP_CONFIG.userInfo?void(O||(O=1,P($(this)))):void seajs.use("login_sns",function(a){a.init()})}),$(document).mouseup(function(e){var a=$(".js-search-tag");a.is(e.target)||0!=a.has(e.target).length||($(".js-search-tag").hide(),$(".search-tags-ipt").val(""))}),$(".wd-scroll .to-top").on("click",function(){$("html,body").animate({scrollTop:0},100)}),$(document).on("click",".switch-close",function(){$(".switch-pop,.tag-pop").remove()}),$("#main").on("click",".js-leifeng-tab",function(){var a=$(this).attr("data-type");$(".js-leifeng-tab").removeClass("active"),$(this).addClass("active"),$(".js-leifeng-tab-box").hide(),$(".js-leifeng-tab-box").each(function(){a==$(this).attr("data-type")&&$(this).show()})}),$("#main").on("click",".js-lyleif",function(){$(this).parent(".lyleif").hide(),$(this).parents(".js-leifeng-tab-box").children("ul").removeClass("leifeng-tab-box-min")})});
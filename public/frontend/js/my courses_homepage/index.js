define(function(require){require("common"),require("./u_common.js"),require("/static/lib/layer/1.6.0/layer.min.js"),require("/static/lib/layer/1.6.0/skin/layer.css");var a=require("./inc/dynamic_setup"),c=2,h=!0,w=!1;$(document).scroll(function(){if(!$(".js-dynamicLoadwrap").hasClass("js-noreload")&&($(".js-dynamicLoad").text(""),h&&!w)){var a=$(document).scrollTop(),_=$(window).height(),g=$(document).height();g==_+a&&(h=!1,$(".js-dynamicLoad").html('<img src="/static/img/u/loading_fff.gif " style="pr top:5px; margin-right:10px;" width="20" height="20" /> 正在加载更多...'),$.ajax({type:"get",url:"/u/"+space_user.uid+"/getfeedlist?page="+c,dataType:"html",success:function(a){1!=a.length?($(".page-home").append(a),c+=1,$(".js-dynamicLoad").text(""),window._bd_share_main&&window._bd_share_main.init()):(w=!0,$(".js-dynamicLoad").text(""))},error:function(){$(".js-dynamicLoad").text("加载错误")},complete:function(){h=!0}}))}}),$(document).delegate(".js-share","mouseover",function(e){var a=$(e.currentTarget).attr("data-shareid");$(".bdsharebuttonbox").find("a").each(function(){$(this).attr("data-cmd")||$(this).remove()}),$(".share-box").find(".bdsharebuttonbox").attr("data-tag",a);{var c=$("."+a).attr("data-objtype"),h=$("."+a).attr("data-title"),w=$("."+a).attr("data-tuid"),_=$("."+a).attr("data-img");$("."+a).attr("data-nickname")}0==c&&(window._bd_share_config.share.bdText="我正在参加@慕课网  的一门课程【"+h+"】，很不错哦！快来一起学习吧！(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/view/"+w+"?summary=1111111111",window._bd_share_config.share.bdPic="https://img.mukewang.com/"+_+".jpg"),1==c&&(window._bd_share_config.share.bdText="我正在参加@慕课网  的一门课程【"+h+"】，很不错哦！快来一起学习吧！(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/view/"+w,window._bd_share_config.share.bdPic="https://img.mukewang.com/"+_+".jpg"),32==c&&(window._bd_share_config.share.bdText="[慕课猿问："+h+"(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/wenda/detail/"+w,window._bd_share_config.share.bdPic="https://img.mukewang.com/"+_+".jpg"),33==c&&(window._bd_share_config.share.bdText="[慕课猿问："+h+"(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/wenda/detail/"+w,window._bd_share_config.share.bdPic="https://img.mukewang.com/"+_+".jpg"),48==c&&(window._bd_share_config.share.bdText="我刚刚在@慕课网 读了篇好文章："+h+"_慕课网_手记(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/article/"+w,window._bd_share_config.share.bdPic="undefined"!=typeof _&&$.trim(_.length)>0?"https://img.mukewang.com/"+_+".jpg":"https://www.imooc.com/static/img/index/logo_new.png"),49==c&&(window._bd_share_config.share.bdText="我刚刚在@慕课网 读了篇好文章："+h+"_慕课网_手记(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/article/"+w,window._bd_share_config.share.bdPic="undefined"!=typeof _&&$.tirm(_.length)>0?"https://img.mukewang.com/"+_+".jpg":"https://www.imooc.com/static/img/index/logo_new.png"),50==c&&(window._bd_share_config.share.bdText="我刚刚在@慕课网 读了篇好文章："+h+"_慕课网_手记(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/article/"+w,window._bd_share_config.share.bdPic="undefined"!=typeof _&&$.trim(_.length)>0?"https://img.mukewang.com/"+_+".jpg":"https://www.imooc.com/static/img/index/logo_new.png"),80==c&&(window._bd_share_config.share.bdText="我正在参加@慕课网  的一个学习路径【"+h+"路径】，很不错哦！快来一起学习吧！(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="https://www.imooc.com/course/programdetail/pid/"+w,window._bd_share_config.share.bdPic="https://img.mukewang.com/"+_+".jpg"),96==c&&(window._bd_share_config.share.bdText="我正在参加@慕课网  的一门课程【"+h+"】，很不错哦！快来一起学习吧！(分享自@慕课网)#慕课爱分享#",window._bd_share_config.share.bdUrl="http://coding.imooc.com/class/"+w+".html",window._bd_share_config.share.bdPic=_),window._bd_share_main&&window._bd_share_main.init(),$("."+a).show();var g;$(this).on("mouseleave",function(){g=setTimeout(function(){$("."+a).hide()},300)}),$("."+a).on("mouseover",function(){clearTimeout(g)}),$("."+a).on("mouseleave",function(){$("."+a).hide()})});var _=user.uid,g={layerok:function(a){$("#Prompt-layer").find(".Prompt-layer-text").html(a),$("#Prompt-layer").find(".Prompt-layer-icon").removeClass("erricon").addClass("succicon"),this._layer()},layererr:function(a){$("#Prompt-layer").find(".Prompt-layer-text").html(a),$("#Prompt-layer").find(".Prompt-layer-icon").removeClass("succicon").addClass("erricon"),this._layer()},_layer:function(){var a=$.layer({type:1,title:!1,closeBtn:!1,bgcolor:!1,border:!1,area:["200","auto"],page:{dom:"#Prompt-layer"}});$("#Prompt-layer").css("display","inline-block"),setTimeout(function(){$(".xubox_shade").hide(),$("#Prompt-layer").fadeOut("hide",function(){layer.close(a)})},500)}};$("#notices").on("click",".notice",function(){var a=$(this),c=a.closest(".notice"),h=c.attr("note-id");$.ajax({type:"POST",url:"/u/"+_+"/notice/"+h,dataType:"json",success:function(a){0==a.result&&(c.find(".notice-con").addClass("pass"),c.find(".notice-type").addClass("already-read"))}})}),$("#notices").on("click",".tag-read-btn",function(){var a=($(this),$(".notice-list"));return a.children(".notice").length<1?void g.layerok("您没有未读通知"):void $.ajax({type:"POST",url:"/u/"+_+"/notices",dataType:"json",success:function(a){0==a.result?(g.layerok("标记已读成功"),location.reload()):(g.layererr("标记已读失败"),location.reload())}})}),$("#notices").on("click",".icon-del",function(e){var a=$(this),c=a.closest(".notice"),h=$(".notice-list"),w=c.attr("note-id");e.stopPropagation(),$.ajax({type:"delete",url:"/u/"+_+"/notice/"+w,dataType:"json",success:function(a){0==a.result?c.animate({height:"0"},function(){if($(this).remove(),h.children(".notice").length<1){if($(".page")[0])return void(location.href=location.href.split("?")[0]);h.html("<div class='no-notice'>暂无任何通知</div>")}}):(g.layererr("删除失败"),location.reload())}})}),$("#notices").on("click",".tip-setting",function(){a.init()}),$(".share-box .show-btn").on("mouseenter",function(){var a=$(this),c=a.parent();c.hasClass("hover")||c.addClass("hover")}).on("mouseleave",function(e){e.stopPropagation();var a=$(this),c=a.parent();c.hasClass("hover")&&c.removeClass("hover")}),$(".list-item .share-box .share-box-con").on("mouseenter",function(){var a=$(this),c=a.parent();c.hasClass("hover")||c.addClass("hover")}).on("mouseleave",function(e){if(e.stopPropagation(),$(e.target).hasClass("share-box-con")){var a=$(this),c=a.parent();c.hasClass("hover")&&c.removeClass("hover")}}),0==$(".share-box-con").find(".icon-edit").length&&$(".bdsharebuttonbox").css("width","138px");var b=$(".bds"),y=0;b.on("click",function(e){if(!y){var a=$(this).parents(".share-box").attr("data-tuid"),c=$(this).parents(".share-box").attr("data-objtype"),h="";0==c&&(h=1),1==c&&(h=1),32==c&&(h=4),33==c&&(h=4),48==c&&(h=5),49==c&&(h=5),50==c&&(h=5),80==c&&(h=7),y=1,$.ajax({type:"post",url:"/course/courseshare",data:"id="+a+"&type="+h,success:function(){y=0},error:function(){layer.msg("网络错误，请稍后再试",1,1)},complete:function(){isAjax=0}}),e.preventDefault()}})});